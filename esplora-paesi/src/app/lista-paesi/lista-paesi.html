<section class="page">

  <!-- HERO -->
  <header class="page-hero">
    <p class="page-badge">Esplora il mondo</p>
    <h1>Tutti i Paesi</h1>
    <p class="page-subtitle">
      Cerca un paese, filtra per regione e apri la scheda dettagliata con
      capitale, popolazione, lingue e bandiera.
    </p>
  </header>

  <!-- FILTRI -->
  <section class="filters">
    <div class="filters-row">
      <!-- NOME -->
      <div class="field">
        <label for="search">Cerca Paese</label>
        <input
          id="search"
          type="text"
          placeholder="Es. Italy, Spain, Brazil..."
          [(ngModel)]="filtroNome"
          (ngModelChange)="onFiltroChange()"
        />
      </div>

      <!-- REGIONE -->
      <div class="field">
        <label for="region">Regione</label>
        <select
          id="region"
          [(ngModel)]="filtroRegione"
          (ngModelChange)="onFiltroChange()"
        >
          <option value="">Tutte le regioni</option>
          <option *ngFor="let r of regioni" [value]="r">{{ r }}</option>
        </select>
      </div>

      <!-- ORDINAMENTO -->
      <div class="field">
        <label for="sort">Ordina per</label>
        <select
          id="sort"
          [(ngModel)]="sortMode"
          (ngModelChange)="onFiltroChange()"
        >
          <option value="nome-asc">Nome A â†’ Z</option>
          <option value="nome-desc">Nome Z â†’ A</option>
          <option value="pop-asc">Popolazione crescente</option>
          <option value="pop-desc">Popolazione decrescente</option>
        </select>
      </div>
    </div>

    <!-- RIGA SOTTO: SOLO PREFERITI + BOTTONI -->
    <div class="filters-footer">
      <label class="fav-toggle">
        <input
          type="checkbox"
          [(ngModel)]="soloPreferiti"
          (ngModelChange)="onFiltroChange()"
        />
        <span class="fake-check"></span>
        <span>Mostra solo preferiti</span>
        <span class="star-icon">â˜…</span>
      </label>

      <div class="filters-actions">
        <button type="button" (click)="applicaFiltri()">Filtra</button>
        <button type="button" class="ghost" (click)="resetFiltri()">Reset</button>
      </div>
    </div>
  </section>

  <!-- INFO BOX -->
  <section class="info-grid">
    <article class="info-card">
      <div class="info-icon">ğŸŒ</div>
      <h2>Database Completo</h2>
      <p>Oltre 250 paesi e territori con informazioni aggiornate.</p>
    </article>

    <article class="info-card">
      <div class="info-icon">ğŸš©</div>
      <h2>Bandiere in HD</h2>
      <p>Bandiere in alta qualitÃ  perfette per i display moderni.</p>
    </article>

    <article class="info-card">
      <div class="info-icon">ğŸ“Š</div>
      <h2>Dati Demografici</h2>
      <p>Popolazione, capitale, lingue e altre info utili.</p>
    </article>
  </section>

  <!-- LISTA PAESI -->
  <section class="countries">
    <header class="countries-header">
      <h2>Risultati</h2>

      <p *ngIf="isLoading">Caricamento paesiâ€¦</p>

      <p *ngIf="!isLoading && paesiFiltrati?.length">
        {{ paesiFiltrati.length }} paesi trovati
        <span *ngIf="soloPreferiti"> Â· solo preferiti</span>
      </p>

      <p *ngIf="!isLoading && !paesiFiltrati?.length">
        Nessun paese trovato con i filtri selezionati.
      </p>
    </header>

    <!-- GRID -->
    <div class="countries-grid" *ngIf="!isLoading && paesiFiltrati?.length">
      <article
        class="country-card"
        *ngFor="let p of paesiFiltrati"
        [routerLink]="['/dettaglio-paese', p.cca3]"
      >
        <div class="flag-box">
          <button
            class="fav-btn"
            [class.active]="isPreferito(p.cca3)"
            (click)="togglePreferito($event, p.cca3)"
            title="Aggiungi/rimuovi dai preferiti"
          >
            â˜…
          </button>
          <img [src]="p.flags?.png" [alt]="p.name?.common" />
        </div>
      </article>
    </div>
  </section>
</section>
